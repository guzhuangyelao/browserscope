{% extends "base.html" %}

{% block body %}

<div id="bs-home-intro-c" class="g-section">
  <div id="bs-home-recent-c">
    <div id="bs-home-recent">
      <h3>
        Recent tests
        {% if is_admin %}
          <a href="/clear_memcache?recent=1&continue=/" class="bs-admin">clear</a>
        {% endif %}
      </h3>
      <table id="bs-home-recent-tests" cellpadding="0" cellspacing="0">
        {% for test in recent_tests %}
          <tr>
            <td>{{ test.created|utc_to_pst|date:"P" }}</td>
            <td>{{ test.user_agent_pretty }}</td>
            <td>{{ test.category }}</td>
            <td>
              {% if test.display %}
                {{ test.display }}
              {% else %}
                {{ test.score }}
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </table>
    </div>
  </div>
  <div id="bs-home-intro-u">
    <p id="bs-home-intro">
      {{ app_title }} is a community-driven project for profiling web browsers.
      The goals are to foster innovation by tracking browser functionality and to be a resource for web developers.
    </p>
    <p id="bs-home-intro-sub">
      Gathering test results from users "in the wild" is the most important and useful feature of {{ app_title }} - and you can participate!
    </p>
    <p>
      <a href="/alltests" class="bs-btn">How Does Your Browser Compare?</a>
    </p>
    <!--
    <p>
      So far <strong>X</strong> users have run the tests <strong>X</strong> times on <strong>X</strong> unique browsers.
    </p>
    -->
  </div>
</div>

<div id="bs-home-cur-ua">
  <span class="bs-cur-ua goog-inline-block"></span>
  <span>
    We think you're using
    <strong id="bs-home-cur-ua-s">{{ current_ua }}</strong>
  </span>
  <a
    href="http://code.google.com/p/browserscope/issues/entry?template=UA%20Parsing%20Is%20Incorrect&comment={{ current_ua }} is not {{ current_ua_string }}"
    target="_blank">No?</a>
</div>
{% if message %}
  <p class="d-msg">{{ message }}</p>
{% endif %}
<div id="bs-results">
  <ul id="bs-results-bycat" class="bs-results-bycat bs-compact">
    {% ifequal stats_table_category "summary" %}
      <li
        id="summary-results">
        <h3>Summary</h3>
        {{ stats_table|safe }}
      </li>
    {% endifequal %}
    {% for app_category in app_categories %}
      {% with app_category|by_key:0 as category %}
        <li
          id="{{ category }}-results">
          <h3>{{ app_category|by_key:1 }}</h3>
          {% ifequal stats_table_category category %}
            {{ stats_table|safe }}
          {% else %}
            <a
              id="{{ category }}-results-link"
              href="/?category={{ category }}&{{ results_params }}">View the {{ app_category|by_key:1 }} Results Table</a>
          {% endifequal %}
        </li>
      {% endwith %}
    {% endfor %}
  </ul>
</div>

{% ifequal build "production" %}
  <script src="{{ "browserscope.js"|resource_path }}"></script>
{% else %}
  <script src="{{ "dev.js"|resource_path }}"></script>
  <script src="{{ "util.js"|resource_path }}"></script>
{% endifequal %}


<script>
  (function(){
    var category = '{{ stats_table_category }}';
    var httpUserAgent = '{{ current_ua_string }}';
    var output = '{{ output }}';
    var userAgentPretty = '{{ current_ua }}';
    var realUaString = Util.reconcileClientServerUaPretty(httpUserAgent,
        userAgentPretty);
    var resultsUriParams = '{{ results_params }}';
    var uaUriParams = '{{ ua_params }}';
    var browserFamily = '{{ v }}';
    var controller = new Util.ResultTablesController(category,
        browserFamily, output, realUaString, uaUriParams, resultsUriParams);
    if (realUaString != userAgentPretty) {
      var curUaStringEl = document.getElementById('bs-home-cur-ua-s');
      curUaStringEl.innerHTML = realUaString;
    }
    var cb = Util.createChromeFrameCheckbox(httpUserAgent, true);
    if (cb) {
      var curUaStringContainer = document.getElementById('bs-home-cur-ua');
      curUaStringContainer.appendChild(cb);
    }
  })();
</script>
<script src="http://www.google.com/jsapi" defer></script>

{% endblock %}

